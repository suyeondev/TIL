# 토픽모델

## 백오브워즈와 음수 미포함 행렬 분해

백오브원즈 분석이란?

각 문서에서 단어의 출현 빈도를 행렬로 표현한 것.

대부분 요소는 0이 된다. 이처럼 값이 거의 0인 행렬을 희소행렬이라고 부른다.



문서 군의 요약을 구할 때는 이 희소행렬을 분해하는 방법을 사용하는 경우도 있다.

1. 특잇값 분해 (잠재 의미 분석)
2. 음수 미포함 행렬 분해 - 행렬의 각 요소가 양수인 성질에 주목하여



X가 음수 미포함 행렬이라면 W와 H를 음수 미포함으로 가정해서 다음처럼 분해할 수 있다.

![음수미포함행렬분해](https://user-images.githubusercontent.com/86271820/154209748-8079a604-4494-44e1-8e7c-c09f7152fc19.jpg)



## 동전 던지기 모델



앞면이 나올 확률이 θ인 동전이 있다. 이 동전을 다섯 번 던져서 나온 결과를 x1, x2, x3, x4, x5라고 한다면 당연히 θ의 값에 따라 결과가 나오는 방식이 달라진다. θ = 0.5라면 앞면이 나올 확률과 뒷면이 나올 확률은 같다. θ = 0.9라면 앞면이 나올 확률이 높아진다. 



관측변수 : 동전의 앞뒤 등을 관측할 수 있는 변수

잠재변수 : 앞면이 나올 확률 등 직접 관츨할 수 없는 변수

사전분포 : 사전에 알고 있는 정보를 반영한 확률 분포

최대 우도 추정값 : 사전 정보를 포함하지 않는 추정값

최대 사후확률 추정값 : 사전정보를 포함하는 추정값 

- 사전정보를 포함함으로써 데이터가 적을 때도 극단적인 추정값이 되는 것을 방지할 수 있다.



## 사전분포와 정규화

일반적으로 공백사전분포인 베타분포를 이용한다. 

공백사전분포는 사전분포와 우도를 곱한 후의 사후분포의 형태가 사전분포와 같아진다는 성질이 있다 ⇒ 계산이 매우 편해진다.  베타분포는 다음 식으로 정의된다.
$$
f(θ|a_1,a_2) =  \frac { 1 } { C } θ^{a_1-1} (1-θ)^{a_2-1}
$$
여기서 a1, a2는 양수이고, C는 f를 확률밀도 함수로 만들기 위한 정규화 상수이다. 이 분포는 0에서 1사이에 값을 취하며, 파라미터에 따라 확률 p가 0.5 근처에 있는지 0이나 1중 한쪽으로 치우치는지 표현할 수 있다.

다시 말해 동전 던지기의 예로 비유하자면, 전자의 상황은 사전분포로서 균등한 동전을 표현하는게 되고, 후자는 어느 쪽인지 알 수 없지만 극단으로 치우친 상황을 나타내게 된다.

![베타분포](https://user-images.githubusercontent.com/86271820/154414164-98f89858-e2f2-4f0a-a13b-68c3a10eaf03.jpg)

이런 사전분포의 정규화 역할을 이용한 것이 LDA이다.





[참고문헌] - 그림으로 배우는 데이터과학 Data Science - 히사노 료헤이, 키와키 타이치 지음 김성훈 옮김

